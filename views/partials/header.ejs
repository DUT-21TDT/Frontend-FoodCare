<!-- login or not login -->
<link rel="stylesheet" href="../assets/css/Avatar.css">
<link rel="stylesheet" href="../assets/css/ChangePassword.css">
<link rel="stylesheet" href="../assets/css/EditProfile.css">
<link rel="stylesheet" href="../assets/css/ForgetPassword.css">
<link rel="stylesheet" href="../assets/css/Notification-form.css">
<link rel="stylesheet" href="../assets/css/ResetPassword.css">
<% if (!userId) { %>
    <nav class="navbar navbar-expand-lg bg-body-tertiary" id="header">
        <div class="container">
            <div class="g-col-3" style="width: 100px;">
                <a class="navbar-brand" href="/">
                    <img src="../assets/images/FooCA.png" alt="Logo" width="70" height="70"
                        class="d-inline-block align-text-center">
                </a>
            </div>
            <div class="g-col-7">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0" id="nav">
                    <li class="nav-item text-center">
                        <a href="/" class="nav-link">
                            <span class="d-none d-sm-inline-block">Home</span>
                            <span class="d-inline-block d-sm-none text-truncate">Home</span>
                        </a>
                    </li>
                    <li class="nav-item text-center">
                        <a href="/#food_information" class="nav-link">
                            <span class="d-none d-sm-inline-block">Food Information</span>
                            <span class="d-inline-block d-sm-none text-truncate">Information</span>
                        </a>
                    </li>
                    <li class="nav-item text-center">
                        <a href="/#bmi_calculator" class="nav-link">BMI</a>
                    </li>
                    <li class="nav-item text-center">
                        <a href="/#menu_nutrition" class="nav-link">
                            <span class="d-none d-sm-inline-block">Menu Nutrition</span>
                            <span class="d-inline-block d-sm-none text-truncate">Menu</span>
                        </a>
                    </li>
                    <li class="nav-item text-center">
                        <a href="/#food_suggestion" class="nav-link">Food Suggestion</a>
                    </li>
                </ul>
            </div>
            <div class="g-col-2">

                <div class="header-user" style="position: relative;">
                    <button class="user-signUp js-click-register">
                        Sign Up
                        <i class="fa-solid fa-user-plus icon"></i>
                    </button>

                    <button class="user-login js-click-login">
                        Login
                        <i class="fa-solid fa-right-to-bracket icon"></i>
                    </button>
                    <form action="" id="forgetpw">
                        <div class="ForgetPassword" style="display: none;">
                            <a href="" class="ForgetPassword__xmark"><i
                                    class="fa-solid fa-xmark ForgetPassword__iconback"></i></a>
                            <h1 class="ForgetPassword__title">Forgot Password</h1>
                            <p class="ForgetPassword__text">No Problem! Enter your email or username below and we will
                                send you an
                                email with instruction to reset your password.</p>
                            <input type="text" class="ForgetPassword__input" placeholder="Email or Username">
                            <i class="fa-solid fa-check ForgetPassword__checkEmail"></i>
                            <button class="ForgetPassword__button">Send Reset Link</button>
                            <p class="ForgetPassword__text">Back to
                                <a href="" class="ForgetPassword__returnLogin">Login</a>
                            </p>
                        </div>
                    </form>
                </div>

            </div>
        </div>


    </nav>
    <script>
        $(document).ready(function () {
            // Smooth scrolling for anchor links with fixed distance
            $('a[href^="#"]').on('click', function (event) {
                event.preventDefault();

                var target = $(this.getAttribute('href'));
                if (target.length) {
                    var scrollDistance = 600; // Adjust this value to set the desired scroll distance in pixels
                    var targetPosition = target.offset().top - scrollDistance;
                    $('html, body').stop().animate({
                        scrollTop: targetPosition
                    }, 800);
                }
            });
        });
    </script>

    <div id="login_modal" class="user_modal js-user_modal">
        <div class="login_container js-login_container">
            <div class="close_btn js-modal-close">
                <i class="fa-regular fa-circle-xmark fa-xl"></i>
            </div>
            <div class="header_flogin">
                <h2>LOGIN</h2>
            </div>

            <div class="body_flogin">
                <form action="/" class="login_form" id="login-form" method="post">
                    <label for="username">Username</label>
                    <br>
                    <input placeholder="Your username is" type="text" name="username" id="login_username"
                        autocomplete="off">
                    <label for="password">Password</label>
                    <br>
                    <input placeholder="Your password is" type="password" name="password" id="login_password"
                        autocomplete="new-password">
                    <a href="#" class="forgot_pass"><span>Forgot password?</span></a>
                    <div class="login_fbtn">
                        <button type="submit" class="btn btn-primary validate_login-btn">Login</button>
                    </div>
                </form>
                <div class="login_way">
                    <p>Or login with</p>
                    <i class="fa-brands fa-facebook fa-2xl"></i>
                    <i class="fa-solid fa-envelope fa-2xl"></i>
                    <i class="fa-brands fa-github fa-2xl"></i>
                </div>
            </div>

            <div class="footer_flogin">
                <p>Don't have an account?<button class="js-click-register form_direct">Sign up</button></p>
            </div>
        </div>
    </div>

    <div id="signup_modal" class="signup_modal js-userregister_modal">
        <div class="signup_container js-register-container">
            <div class="close_btn js-modal-close">
                <i class="fa-regular fa-circle-xmark fa-xl"></i>
            </div>
            <div class="header_flogin">
                <h2>Sign Up</h2>
            </div>

            <div class="body_flogin">
                <form action="/signup" class="signup_form container" method="post" id="signup-form" autocomplete="off">
                    <div class="row justify-content-md-center">
                        <div class="col-6 lform enter_info">
                            <label for="username">Full name</label>
                            <br>
                            <input placeholder="Your fullname is" type="text" name="fullname" id="register_fullname"
                                autocomplete="off">
                            <label for="username">Email</label>
                            <br>
                            <input placeholder="Your email is" type="text" name="email" id="register_email"
                                autocomplete="new-password">
                            <label for="username">Username</label>
                            <br>
                            <input placeholder="Your username is" type="text" name="username" id="register_username"
                                autocomplete="off">
                            <label for="username">Password</label>
                            <br>
                            <input placeholder="Your password is" type="password" name="password" id="register_password"
                                autocomplete="off">

                        </div>
                        <div class="col-6 rform enter_info">
                            <label for="date">Birth</label>
                            <br>
                            <input type="date" name="birth" id="birthday" autocomplete="off">
                            <div class="sex_box">
                                <label for="gender">Gender</label>
                                <br>
                                <input type="radio" name="gender" id="male" value="male" checked>
                                <label for="male">Male</label><br>
                                <input type="radio" name="gender" id="female" value="female">
                                <label for="female">Female</label>
                            </div>
                            <label class="pass_again" for="password_again" autocomplete="off">Password again</label>
                            <br>
                            <input placeholder="Enter password again" type="password" name="password_again"
                                id="register_password_again" autocomplete="off">
                        </div>
                    </div>
                    <div class="signup_fbtn">
                        <button type="submit" class="btn btn-primary validate_register-btn">Sign up</button>
                    </div>
                </form>
                <div class="signup_way">
                    <p>Or sign up with</p>
                    <i class="fa-brands fa-facebook fa-2xl"></i>
                    <i class="fa-solid fa-envelope fa-2xl"></i>
                    <i class="fa-brands fa-github fa-2xl"></i>

                    <div class="footer_signup">
                        <p>Already have an account? <button class="js-click-login form_direct">Login</button></p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script src="../assets/js/validator.js"></script>

    <script>
        function checkErrorVisibility() {
            var errorLabels = document.getElementsByClassName("error");
            var loginButton = document.querySelector("#login-form button[type='submit']");
            var registerButton = document.querySelector("#signup-form button[type='submit']");
            var hasHiddenError = true;

            for (var i = 0; i < errorLabels.length; i++) {
                var label = errorLabels[i];
                var displayStyle = window.getComputedStyle(label).getPropertyValue("display");

                if (displayStyle === "none") {
                    hasHiddenError = false;
                    break; // Exit the loop if any error label is hidden
                }
            }

            loginButton.disabled = hasHiddenError;
            registerButton.disabled = hasHiddenError;
        }

        // Check if the notification query parameter exists in the URL
        const urlParams = new URLSearchParams(window.location.search);
        if (urlParams.has('notification')) {
            // Get the notification message from the query parameter
            const notificationMessage = urlParams.get('notification');

            // Show the notification using alert()
            alert(notificationMessage);

            // Remove the notification query parameter from the URL without refreshing the page
            window.history.replaceState({}, document.title, window.location.pathname);
        }
    </script>




    <% } else { %>

        <nav class="navbar navbar-expand-lg bg-body-tertiary" id="header">
            <div class="container">
                <div class="g-col-3" style="width: 100px;">
                    <a class="navbar-brand" href="/">
                        <img src="../assets/images/FooCA.png" alt="Logo" width="70" height="70"
                            class="d-inline-block align-text-center">
                    </a>
                </div>
                <div class="g-col-7">
                    <ul class="navbar-nav me-auto mb-2 mb-lg-0" id="nav" ;>
                        <li class="nav-item text-center"><a href="/">Home</a></li>
                        <li class="nav-item text-center"><a href="/#food_information">Food
                                Information</a></li>
                        <li class="nav-item text-center"><a href="/#bmi_calculator">BMI</a>
                        </li>
                        <li class="nav-item text-center"><a href="/#menu_nutrition">Menu
                                Nutrition</a></li>
                        <li class="nav-item text-center"><a href="/#food_suggestion">Food
                                Suggestion</a></li>
                    </ul>

                </div>

                <div class="g-col-2" style="position: relative;">
                    <!-- Mapping -->
                    <div class="nofi_avatar">

                        <a href="" class="EditProfile__header-avatar">
                            <div class="avatar-img">
                                <img src="" alt="" id="avatar">
                            </div>
                            <!-- Mapping -->
                            <div class="absolutee-container">
                                <div class="list-ava">
                                    <div class="list-ava__header">
                                        <a href="" class="list-ava__header-avatar">
                                            <div class="avatar-img">
                                                <img src="" alt="" id="avatar-holder">
                                            </div>
                                        </a>
                                        <a class="list-ava__header--name" id="fullName">

                                        </a>
                                    </div>
                                    <div class="line"></div>
                                    <div class="list-ava__body">
                                        <div class="list-ava__body-item">
                                            <i class="list-ava__body-item--icon fa-solid fa-user"></i>
                                            <a href="/user/profile" class="list-ava__body-item2 myProfile">My
                                                Profile</a>
                                        </div>
                                        <div class="list-ava__body-item">
                                            <i class="list-ava__body-item--icon fa-solid fa-gear"></i>
                                            <a href="/user/editprofile" class="list-ava__body-item2 editProfile">Edit
                                                Profile</a>
                                        </div>
                                        <div class="list-ava__body-item">
                                            <i class="list-ava__body-item--icon fa-solid fa-burger"></i>
                                            <a href="/user/myMenu" class="list-ava__body-item2 myMenu">My menu</a>
                                        </div>
                                        <div class="list-ava__body-item">
                                            <i class="list-ava__body-item--icon fa-solid fa-right-from-bracket"></i>
                                            <a href="/logout" class="list-ava__body-item2 logOut">Log
                                                out</a>
                                        </div>
                                    </div>
                                </div>
                            </div>




                            <form action="" id="forgetpw">
                                <div class="ForgetPassword">
                                    <a href="" class="ForgetPassword__xmark"><i
                                            class="fa-solid fa-xmark ForgetPassword__iconback"></i></a>
                                    <h1 class="ForgetPassword__title">Forgot Password</h1>
                                    <p class="ForgetPassword__text">No Problem! Enter your email or username below and
                                        we will send you an email with instruction to reset your password.</p>
                                    <input type="text" class="ForgetPassword__input" placeholder="Email or Username">
                                    <i class="fa-solid fa-check ForgetPassword__checkEmail"></i>
                                    <button class="ForgetPassword__button">Send Reset Link</button>
                                    <p class="ForgetPassword__text">Back to
                                        <a href="" class="ForgetPassword__returnLogin">Login</a>
                                    </p>
                                </div>
                            </form>
                            <div class="notifications-message">

                            </div>
                        </a>
                    </div>

                </div>
            </div>

        </nav>

        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.19.5/additional-methods.min.js"></script>

        <script>
            function LoadCss(url) {
                var link = document.createElement("link");
                link.type = "text/css";
                link.rel = "stylesheet";
                link.href = url;
                document.querySelector("head").appendChild(link);
            }
            function LoadScript(url) {
                var script = document.createElement('script');
                script.setAttribute('src', url);
                script.setAttribute('async', false);
                document.head.appendChild(script);
            }
            $(document).ready(function () {

                $(".EditProfile__header-avatar").click(function (event) {
                    event.preventDefault();
                    $(".list-ava").slideToggle();
                    $("body").click(function () {
                        $(".list-ava").slideUp(400);
                    });
                    $("i").click(function () {
                        $(".list-ava").slideUp(250);
                    });
                    event.stopPropagation();
                });

                $(".myProfile").on({
                    click: function (event) {

                        $(".list-ava").slideUp(250);





                    }
                })
                $(".ChangePassword_footer__forgetPass").on({
                    click: function (event) {

                        event.preventDefault();
                        $(".ChangePassword").fadeOut("fast");
                        $(".ForgetPassword").fadeIn("slow");
                        // $("#container_w100").css("opacity","0.5");
                        // $("#content").css("opacity","0.5");

                    }

                });
                $(".ChangePassword_footer__button").mousemove(function () {
                    $(".ChangePassword_footer__button").css("background-color", "#474747");
                });
                $(".ChangePassword_footer__button").mouseleave(function () {
                    $(".ChangePassword_footer__button").css("background-color", "#919191");
                });
                $(".changePassword_xmark").click(function (event) {
                    event.preventDefault();
                    $(".ChangePassword").fadeOut("fast");

                });

            });
        </script>
        <script src="/assets/js/main/header.js"></script>
        <% } %>